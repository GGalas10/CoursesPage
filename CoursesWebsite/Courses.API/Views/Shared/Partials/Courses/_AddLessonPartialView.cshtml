@model Guid
<link rel="stylesheet" href="~/css/Course/AddLesson.css" asp-append-version="true" />
<section class="FullPageEdit">
    <section class="MainSectionEdit GlassEfectSection">
        <p class="ExitBtn" onclick="ReturnAddLessonView()">
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="25px" height="25px" viewBox="0 0 121.31 122.876" enable-background="new 0 0 121.31 122.876" xml:space="preserve"><g><path fill-rule="evenodd" clip-rule="evenodd" d="M90.914,5.296c6.927-7.034,18.188-7.065,25.154-0.068 c6.961,6.995,6.991,18.369,0.068,25.397L85.743,61.452l30.425,30.855c6.866,6.978,6.773,18.28-0.208,25.247 c-6.983,6.964-18.21,6.946-25.074-0.031L60.669,86.881L30.395,117.58c-6.927,7.034-18.188,7.065-25.154,0.068 c-6.961-6.995-6.992-18.369-0.068-25.397l30.393-30.827L5.142,30.568c-6.867-6.978-6.773-18.28,0.208-25.247 c6.983-6.963,18.21-6.946,25.074,0.031l30.217,30.643L90.914,5.296L90.914,5.296z" /></g></svg>
        </p>
        <form id="LessonForm">
        <h1>Dodaj lekcję</h1>
        <div style="width: 80%;margin: auto;display: flex;flex-flow: column;">
            <input name="topicId" type="hidden" value="@Model" id="topicId" />
            <label for="lessonName">Nazwa lekcji:</label>
            <input type="text" name="lessonName" maxlength="100" id="lessonName" required/>
            <label for="lessonDescription">Opis lekcji</label>
            <textarea name="lessonDescription" maxlength="300" id="lessonDescription" required></textarea>
        </div>
        <button class="PrimaryBtn" onclick="ComingSoon()">Dodaj film</button>
        <p class="PrimaryBtn ButtonFromP" onclick="AddNewLesson()">Zapisz</p>
        </form>
    </section>
</section>
<script>
    function ComingSoon() {
        alert("Jak będzie FTP to będzie dodawanie :)");
    }
    function AddNewLesson() {
        var form = document.getElementById("LessonForm");
        if (!form.checkValidity()) {
            alert("Wypełnij wszystkie pola");
            form.reportValidity()
            return;
        }
        var dataForm = new FormData(form);
        var dataClone = {
            topicId: document.getElementById("topicId").value,
            lessonName: document.getElementById("lessonName").value,
        };
        $.ajax({
            url: "/AdminCourses/AddLessonToTopic",
            method: "POST",
            data :dataForm,
            dataType: 'JSON',
            processData: false,
            contentType: false,
            success: function (data) {
                ReturnAddLessonView();
                console.log(`Topic_${dataClone.topicId}`);
                document.getElementById(`Topic_${dataClone.topicId}`).innerHTML += `<div>${data}. ${dataClone.lessonName}</div>`;
            },
            error: function (err) {
                console.log(err);
            },
        })
    }
</script>